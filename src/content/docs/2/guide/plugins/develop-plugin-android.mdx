---
title: Developing an Android plugin
---

A Tauri plugin for Android is defined as a Kotlin class that extends `app.tauri.plugin.Plugin` and is annoted with `app.tauri.annotation.TauriPlugin`.
Each method annotated with `app.tauri.annotation.Command` can be called by Rust or JavaScript.

Tauri uses Kotlin by default for the Android plugin implementation, but you can switch to Java if you prefer.
After generating a plugin, right click the Kotlin plugin class in Android Studio and select the "Convert Kotlin file to Java file" option from the menu.
Android Studio will guide you through the project migration to Java.

## Plugin Configuration

The plugin instance has a getter for the plugin configuration:

```java
@TauriPlugin
class ExamplePlugin(private val activity: Activity): Plugin(activity) {
  override fun load(webView: WebView) {
    val timeout = this.config.getInt("timeout", 30)
  }
}
```

## Lifecycle Events

- load

The load event is triggered when the plugin is loaded on the webview.

```java
@TauriPlugin
class ExamplePlugin(private val activity: Activity): Plugin(activity) {
  override fun load(webView: WebView) {
    // do some setup on your plugin here
  }
}
```

- onNewIntent

The onNewIntent hook is triggered when the activity is re-launched.
See [Activity#onNewIntent](<https://developer.android.com/reference/android/app/Activity#onNewIntent(android.content.Intent)>) for more information.

```java
import android.content.Intent

@TauriPlugin
class ExamplePlugin(private val activity: Activity): Plugin(activity) {
  override fun onNewIntent(intent: Intent) {
    // handle new intent event
  }
}
```

## Commands

```java
@TauriPlugin
class ExamplePlugin(private val activity: Activity): Plugin(activity) {
    @Command
    fun openCamera(invoke: Invoke) {
        val allowEdit = invoke.getBoolean("allowEdit", false)
        val quality = invoke.getInt("quality", 100)

        val ret = JSObject()
        ret.put("path", "/path/to/photo.jpg")
        invoke.resolve(ret)
    }
}
```

## Permissions

If your plugin requires permissions from the end user, Tauri simplifies the whole process of checking and requesting permissions on Android:

First you need to define the list of permissions you need, and define an alias to identify each group in code. This is done inside the `TauriPlugin` annotation:

```java
@TauriPlugin(
  permissions = [
    Permission(strings = [Manifest.permission.POST_NOTIFICATIONS], alias = "postNotification")
  ]
)
class ExamplePlugin(private val activity: Activity): Plugin(activity) { }
```

Tauri automatically implements two commands for your plugin, `checkPermissions` and `requestPermissions`. You can call that command directly from your NPM package or Rust code:

{/* TODO: PermissionState type should be exported in Tauri */}

- Rust

```rust
use serde::{Serialize, Deserialize};
use tauri::Runtime;

#[derive(Deserialize)]
#[serde(rename_all = "camelCase")]
struct PermissionResponse {
  pub post_notification: PermissionState,
}

#[derive(Serialize)]
#[serde(rename_all = "camelCase")]
struct RequestPermission {
  post_notification: bool,
}

impl<R: Runtime> Notification<R> {
  pub fn request_post_notification_permission(&self) -> crate::Result<PermissionState> {
    self.0
      .run_mobile_plugin::<PermissionResponse>("requestPermissions", RequestPermission { post_notification: true })
      .map(|r| r.post_notification)
      .map_err(Into::into)
  }

  pub fn check_permissions(&self) -> crate::Result<PermissionResponse> {
    self.0
      .run_mobile_plugin::<PermissionResponse>("checkPermissions", ())
      .map_err(Into::into)
  }
}
```

- JavaScript

```javascript
import { invoke } from '@tauri-apps/api/tauri'

type PermissionState = 'granted' | 'denied' | 'prompt' | 'prompt-with-rationale'

interface Permissions {
  postNotification: PermissionState
}

// check permission state
const permission = await invoke<Permissions>('plugin:<your-plugin-name-here>|checkPermissions)

if (permission.postNotification === 'prompt-with-rationale') {
  // show some information to the user about why you need the permission
}

// request permission
if (permission.postNotification.startsWith('prompt')) {
  const state = await invoke<Permissions>('plugin:<your-plugin-name-here>|requestPermissions', { permissions: ['postNotification'] })
}
```

## Plugin Events

Plugin can emit events at any point of time using the `trigger` function:

```java
@TauriPlugin
class ExamplePlugin(private val activity: Activity): Plugin(activity) {
    override fun load(webView: WebView) {
      trigger("load", JSObject())
    }

    override fun onNewIntent(intent: Intent) {
      // handle new intent event
      if (intent.action == Intent.ACTION_VIEW) {
        val data = intent.data.toString()
        val event = JSObject()
        event.put("data", data)
        trigger("newIntent", event)
      }
    }

    @Command
    fun openCamera(invoke: Invoke) {
      val payload = JSObject()
      payload.put("open", true)
      trigger("camera", payload)
    }
}
```

You can add helper functions on your NPM package by using the addPluginListener helper function:

```javascript
import { addPluginListener, PluginListener } from '@tauri-apps/api/tauri';

export async function onRequest(
	handler: (url: string) => void
): Promise<PluginListener> {
	return await addPluginListener(
		'<your-plugin-name-here>',
		'event-name',
		handler
	);
}
```

{/* TODO: add link for addPluginListener */}
